# CH1 - 도커란 무엇인가?

# 1. 도커란 무엇인가?

## 안개 속에 숨겨진 도커의 정체는?

### 도커는 데이터 또는 프로그램을 격리시키는 기능을 제공한다

- 주로 서버에 사용된다.
    - 클라이언트 컴퓨터에서도 사용할 수는 있지만 현 시점에서는 서버에서 사용하는 것이 주 용도이다.

### 컨테이너와 도커 엔진

- **컨테이너:** 개인용 컴퓨터 또는 서버 상의 환경을 두는 곳
- **도커:** 이 컨테이너를 다루는 기능을 제공하는 소프트웨어

### 컨테이너를 만들려면 이미지가 필요하다

- 컨테이너를 만들려면 도커 엔진 외에도 컨테이너의 빵틀과도 같은 역할을 할 `이미지`가 필요하다.
- 이미지는 담고 있는 소프트웨어의 종류에 따라 다양한 이미지를 사용한다.
    - 아파치 컨테이너를 만들려면 아파치 이미지를 사용하고, MySQL 컨테이너를 만들려면 MySQL 이미지를 사용해야 한다.

### 도커는 리눅스 컴퓨터에서 사용한다

- 도커를 사용하는 데는 몇가지 제약사항이 있는데, 우선 종류와 상관없이 리눅스 운영체제가 필요하다.
- 컨테이너에서 동작시킬 프로그램도 리눅스용 프로그램이다.
- 이는 도커가 리눅스에서 사용하는 것을 전제로 만들어졌기 때문이다.

## 데이터나 프로그램을 독립된 환경에 격리해야 하는 이유

- 대부분의 프로그램은 프로그램 단독으로 동작하는 것이 아니라 어떤 실행 환경이나 라이브러리, 다른 프로그램을 이용해 동작한다.
- 소프트웨어 역시 단일 프로그램이 아니라 여러 개의 프로그램으로 구성된 경우가 많다.
- 또한 다른 프로그램과 특정한 폴더 또는 디렉토리를 공유하거나 같은 경로에 설정 정보를 저장하는 경우도 있다.
- 이 때문에 프로그램 하나를 업데이트하면 다른 프로그램에도 영향을 미치게 된다.
- 설계할 때는 문제가 없었던 프로그램끼리도 실제로 설치해보면 오류를 일으키는 경우도 있다.
    - 이러한 문제의 원인은 대부분 프로그램 간 공유에 있다.

## 프로그램의 격리란?

- 도커 컨테이너를 사용해 프로그램을 격리하면 여러 프로그램이 한 서버에서 실행되면서 발생하는 문제를 대부분 해결할 수 있다.

# 2. 서버와 도커

## 서버의 두 가지 의미

- 서버란 이름 그대로 **어떤 서비스를 제공하는 것**을 가리킨다.

### 기능적 의미의 서버와 물리적 컴퓨터로서의 서버

- ‘웹 서버’, ‘메일 서버’ 등에서 말하는 서버가 기능적 의미의 서버를 가리킨다.
- 물리적 컴퓨터로서의 서버는 데스크탑 컴퓨터와 마찬가지로 어딘가에 물리적으로 존재하는 컴퓨터이다.
- 개인용 컴퓨터는 개인이 사용하지만 서버는 여러 사람이 원격으로 접근해 사용한다는 점이 다르다.

### 서버의 기능은 소프트웨어가 제공한다.

- `서버의 기능은 소프트웨어가 제공하는 것`으로, 소프트웨어를 설치하면 ‘서버’의 기능을 갖게 된다.
    - 아파치같은 웹 서버 소프트웨어를 설치하면 웹 서버 기능을 갖추며, Sendmail같은 메일 서버 소프트웨어를 설치하면 메일 서버가 된다.
    - 즉 “xx 서버를 만든다”는 말은 “xx용 소프트웨어를 설치해 이 기능을 갖춘다”는 말과 같다.
- 서버의 기능이 소프트웨어에서 나온다는 말은 `여러 가지 소프트웨어를 한 컴퓨터에 설치할 수 있다`는 말이다.
    - 예를 들어 웹 서버와 메일 서버, FTP 서버를 한 컴퓨터에서 제공하는 경우를 볼 수 있다.
    - 여러 기능적 의미의 서버가 하나의 물리적 컴퓨터에 함께 존재할 수 있다.

### 서버의 대표적인 예

- **웹 서버**: 웹 사이트 기능을 제공하는 서버. HTML 파일 또는 이미지 파일, 프로그램을 배치하고, 클라이언트 컴퓨터의 브라우저에서 접근해오면 이들 파일을 제공한다.
    - Apache, Nginx, IIS 등이 있다.
- **메일 서버:** 메일 송수신을 담당하는 STMP 서버와 클라이언트에 메일을 전달하는 POP 서버로 나뉜다. 메일을 내려받지 않고 서버에 둔 채로 읽는 IMAP4 서버도 있다.
    - Sendmail, Postfix 등이 있다.
- **데이터베이스 서버:** 데이터를 저장하거나 검색하는 데이터베이스 기능을 제공하는 서버이다.
- **인증 서버:** 사용자 인증을 위한 서버. 윈도우 네트워크에 로그인하기 위한 Active Directory 서버 또는 무선랜이나 원격 접속에서 사용자 인증을 맡는 Radius 서버 등이 있다.
    - OpenLDAP, Active Directory 등이 있다.

### 서버의 운영체제로는 주로 리눅스가 사용된다

- 서버의 역할 특성상 서버용 운영체제를 사용하는 경우가 많다.
    - 리눅스 또는 유닉스 계열을 주로 사용하며, 서버용 소프트웨어도 리눅스용 소프트웨어가 대다수를 차지한다.
    - 리눅스 계통에서는 레드햇, CentOS, 우분투 등이 유명하다.

## 컨테이너를 이용해 여러 가지 서버 기능을 안전하게 함께 실행하기

- 일반적으로 한 대의 서버 컴퓨터에는 웹 서버를 하나밖에 실행하지 못하지만, 컨테이너 기술을 활용하면 여러 개의 웹 서버를 올릴 수 있다.
    - 그만큼 물리 서버 수를 줄일 수 있기 때문에, 프로젝트 비용이 감소할 것이다.
- 만약 컨테이너 기술을 활용하지 않고 물리 서버 한 대에 두 웹 서버를 함께 올린다면 프로젝트 A에 참여 중인 개발자가 프로젝트 B의 환경을 건드리게 될 수도 있고, 아파치는 서버 한대에 하나밖에 올리지 못하기 때문에 웹 서버의 기능을 공유해야 하는 한계도 생긴다.
- 개발 측면에서의 이점은 개발 환경을 갖추거나 운영 환경으로 쉽게 넘어갈 수 있다는 점 등을 들 수 있다.
    - 이러한 이점은 컨테이너가 그저 격리된 환경이 아니라 `쉽게 옮길 수 있다`는 특성에서 비롯된다.

## 자유로이 옮길 수 있는 컨테이너

- 컨테이너는 자유로이 옮길 수 있다.
- 실제로는 컨테이너 자체를 옮긴다기보다는 컨테이너의 정보를 내보내기한 다음, 다른 도커 엔진에서 복원하는 형태가 되지만 그리 어려운 일이 아니다.
- 이런 특성을 이용하면 똑같은 상태로 튜닝한 컨테이너를 팀원 전원에게 배포해 모두가 동일한 개발환경을 사용할 수 있다.
- 도커를 이용하면 물리적 환경의 차이, 서버 구성의 차이를 무시할 수 있으므로 운영 서버와 개발 서버의 환경 차이로 인한 문제를 원천적으로 방지할 수 있다.

## 도커와 가상화 기술의 차이

- 도커는 특성상 가상화 기술과 비교되는 경우가 많다. 그러나 도커는 서버 가상화와는 분명한 차이가 있다.
    - `실행 환경을 독립적으로 격리한 컨테이너`라고 표현하는 것이 정확하다.
- VirtualBox나 VMware같은 가상화 기술은 가상의 물리 서버를 만드는 것과 같다.
    - 여기서 ‘가상’이라는 말은 물리적인 대상을 소프트웨어로 대체했다는 의미다.
    - 즉 메인보드와 CPU, 메모리 등의 물리적인 부품을 소프트웨어로 구현하는 것이다.
    - 실질적으로 물리 서버와 동등한 것이므로 당연히 운영체제도 아무거나 설치할 수 있고, 그 위에 어떤 소프트웨어를 구동해도 무방하다.
- 이와 달리 도커는 컨테이너에서 리눅스가 동작하는 것처럼 보이지만, 실제로 리눅스가 동작하는 것은 아니다.
    - 운영체제의 기능 중 일부를 호스트 역할을 하는 물리 서버에 맡겨 부담을 덜어둔 형태이다.
    - 다시 말해 컨테이너는 운영체제의 일부 기능을 호스트 컴퓨터에 의존하기 때문에 물리 서버에도 리눅스 기능이 필요하며, 컨테이너의 내용도 리눅스 운영체제가 될 수밖에 없다.

### 도커와 AWS EC2의 차이

- AWS EC2에도 도커의 컨테이너와 비슷한 ‘인스턴스’라는 개념이 있다.
- EC2 역시 가상화 기술이다. 각각의 인스턴스가 완전히 독립된 컴퓨터처럼 동작한다.
    - 따라서 EC2와 도커의 관계는 VirtualBox나 VMware와 도커의 관계와 같다.
- 다만 인스턴스는 컨테이너와 마찬가지로 AMI라는 이미지로부터 생성하므로 인스턴스를 배포하는 방법은 도커와 비슷하다.

### 도커와 호스팅 서비스

- AWS ECS가 이에 해당한다. 이들 서비스를 사용하면 별도로 가상 서버를 만들지 않아도 컨테이너 이미지를 그대로 실행할 수 있다.